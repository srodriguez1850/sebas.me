{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useUnityLoader = void 0;\n\nvar react_1 = require(\"react\");\n\nvar is_browser_environment_1 = require(\"../constants/is-browser-environment\");\n\nvar unity_loader_status_1 = require(\"../enums/unity-loader-status\");\n/**\n * Hook to embed a Unity Loader script.\n * @param source The source of the unity loader.\n * @returns a hook that returns the status of the loader.\n */\n\n\nvar useUnityLoader = function (unityConfig) {\n  var _a = (0, react_1.useState)(unity_loader_status_1.UnityLoaderStatus.Loading),\n      status = _a[0],\n      setStatus = _a[1]; // Effect hook will be invoked when the source changes.\n\n\n  (0, react_1.useEffect)(function () {\n    // It is possible for the application being rendered server side. In\n    // this scenario, the window is not available. We can't create a Unity\n    // Loader in this case.\n    if (is_browser_environment_1.isBrowserEnvironment === false) {\n      return;\n    } // If the script's source is null, we'll reset the status to idle.\n\n\n    if (unityConfig.loaderUrl === null) {\n      setStatus(unity_loader_status_1.UnityLoaderStatus.Idle);\n      return;\n    }\n    /**\n     * Find existing script element by source. It may have been added by\n     * another instance of this hook.\n     */\n\n\n    var script = window.document.querySelector(\"script[src=\\\"\".concat(unityConfig.loaderUrl, \"\\\"]\")); // If there wan't another instance of this script, we're going to create a\n    // new one with the provided source.\n\n    if (script === null) {\n      script = window.document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = unityConfig.loaderUrl;\n      script.async = true;\n      script.setAttribute(\"data-status\", \"loading\"); // Add script to window.document body.\n\n      window.document.body.appendChild(script); // Store status in attribute on script. This can be read by other\n      // instances of this hook.\n\n      script.addEventListener(\"load\", function () {\n        return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"loaded\");\n      });\n      script.addEventListener(\"error\", function () {\n        return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"error\");\n      });\n    } else {\n      // If there already was a script with the same source, grab its existing\n      // script status from attribute and set to state.\n      setStatus(script.getAttribute(\"data-status\") === \"loaded\" ? unity_loader_status_1.UnityLoaderStatus.Loaded : unity_loader_status_1.UnityLoaderStatus.Error);\n    }\n    /**\n     * Script event handler to update status in state. Even if the script\n     * already exists we still need to add event handlers to update the state\n     * for this hook instance.\n     * @param event The event that was triggered.\n     */\n\n\n    var setStateFromEvent = function (event) {\n      return setStatus(event.type === \"load\" ? unity_loader_status_1.UnityLoaderStatus.Loaded : unity_loader_status_1.UnityLoaderStatus.Error);\n    };\n\n    script.addEventListener(\"load\", setStateFromEvent);\n    script.addEventListener(\"error\", setStateFromEvent); // Remove event listeners on cleanup.\n\n    return function () {\n      if (script !== null) {\n        script.removeEventListener(\"load\", setStateFromEvent);\n        script.removeEventListener(\"error\", setStateFromEvent);\n        window.document.body.removeChild(script);\n      }\n    };\n  }, [unityConfig.loaderUrl]);\n  return status;\n};\n\nexports.useUnityLoader = useUnityLoader;","map":{"version":3,"sources":["/Users/sebastian/Documents/GitHub/sebas.me/node_modules/react-unity-webgl/distribution/hooks/use-unity-loader.js"],"names":["Object","defineProperty","exports","value","useUnityLoader","react_1","require","is_browser_environment_1","unity_loader_status_1","unityConfig","_a","useState","UnityLoaderStatus","Loading","status","setStatus","useEffect","isBrowserEnvironment","loaderUrl","Idle","script","window","document","querySelector","concat","createElement","type","src","async","setAttribute","body","appendChild","addEventListener","getAttribute","Loaded","Error","setStateFromEvent","event","removeEventListener","removeChild"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useUnityLoader = void 0;\nvar react_1 = require(\"react\");\nvar is_browser_environment_1 = require(\"../constants/is-browser-environment\");\nvar unity_loader_status_1 = require(\"../enums/unity-loader-status\");\n/**\n * Hook to embed a Unity Loader script.\n * @param source The source of the unity loader.\n * @returns a hook that returns the status of the loader.\n */\nvar useUnityLoader = function (unityConfig) {\n    var _a = (0, react_1.useState)(unity_loader_status_1.UnityLoaderStatus.Loading), status = _a[0], setStatus = _a[1];\n    // Effect hook will be invoked when the source changes.\n    (0, react_1.useEffect)(function () {\n        // It is possible for the application being rendered server side. In\n        // this scenario, the window is not available. We can't create a Unity\n        // Loader in this case.\n        if (is_browser_environment_1.isBrowserEnvironment === false) {\n            return;\n        }\n        // If the script's source is null, we'll reset the status to idle.\n        if (unityConfig.loaderUrl === null) {\n            setStatus(unity_loader_status_1.UnityLoaderStatus.Idle);\n            return;\n        }\n        /**\n         * Find existing script element by source. It may have been added by\n         * another instance of this hook.\n         */\n        var script = window.document.querySelector(\"script[src=\\\"\".concat(unityConfig.loaderUrl, \"\\\"]\"));\n        // If there wan't another instance of this script, we're going to create a\n        // new one with the provided source.\n        if (script === null) {\n            script = window.document.createElement(\"script\");\n            script.type = \"text/javascript\";\n            script.src = unityConfig.loaderUrl;\n            script.async = true;\n            script.setAttribute(\"data-status\", \"loading\");\n            // Add script to window.document body.\n            window.document.body.appendChild(script);\n            // Store status in attribute on script. This can be read by other\n            // instances of this hook.\n            script.addEventListener(\"load\", function () {\n                return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"loaded\");\n            });\n            script.addEventListener(\"error\", function () {\n                return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"error\");\n            });\n        }\n        else {\n            // If there already was a script with the same source, grab its existing\n            // script status from attribute and set to state.\n            setStatus(script.getAttribute(\"data-status\") === \"loaded\"\n                ? unity_loader_status_1.UnityLoaderStatus.Loaded\n                : unity_loader_status_1.UnityLoaderStatus.Error);\n        }\n        /**\n         * Script event handler to update status in state. Even if the script\n         * already exists we still need to add event handlers to update the state\n         * for this hook instance.\n         * @param event The event that was triggered.\n         */\n        var setStateFromEvent = function (event) {\n            return setStatus(event.type === \"load\"\n                ? unity_loader_status_1.UnityLoaderStatus.Loaded\n                : unity_loader_status_1.UnityLoaderStatus.Error);\n        };\n        script.addEventListener(\"load\", setStateFromEvent);\n        script.addEventListener(\"error\", setStateFromEvent);\n        // Remove event listeners on cleanup.\n        return function () {\n            if (script !== null) {\n                script.removeEventListener(\"load\", setStateFromEvent);\n                script.removeEventListener(\"error\", setStateFromEvent);\n                window.document.body.removeChild(script);\n            }\n        };\n    }, [unityConfig.loaderUrl]);\n    return status;\n};\nexports.useUnityLoader = useUnityLoader;\n"]},"metadata":{},"sourceType":"script"}